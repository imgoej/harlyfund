devtools::install_github("IMHarly/harlyfund@head",dependencies = T)
devtools::install_github("IMHarly/harlyfund@master",dependencies = T)
devtools::install_github("IMHarly/harlyfund@master",dependencies = T)
devtools::document()
devtools::install_github("IMHarly/harlyfund@master",dependencies = T)
devtools::document()
devtools::install_github("IMHarly/harlyfund@master", force = TRUE)
devtools::install_github("IMHarly/harlyfund@master",force=TRUE)
library(harlyfund)
transfer_portal()
library(harlyfund)
transfer_portal()
getwd()
transfer_portal()
devtools::document()
devtools::document()
#' transfer_portal()
#'
#' The Harly Fund Transfer Environment
#'
#' @export
transfer_portal <- function() {
options(warn=-1)
cat("\nHello, I am Hubby and Welcome to the Harly Fund Transfer Portal. I will be your service bot today :D \n   I will try and assist you anyway I can.")
cat("\n\nQuiz time! To gain entry, get the right answer to this security question:")
cat("\n####What KDA would Jonathan's Hecarim be riding without Frederik's Zilean?  ")
answer <- readline()
if(answer != "0.4") {
cat("Your answer is clearly not correct. (you should use \".\" as decimal separator")
} else {
cat("\n...\n...\nGood boy/girl!")
cat("\n\nMoney transfers via this process guarantees utmost security, and ensures that necessary \n   permitions have been obtained for your transfer.")
Sys.sleep(2)
if("1a2bcdTL.csv" %in% list.files()){
cat("\n\nI am sorry, but only one transfer request is allowed per week.")
} else{
cat("\n\n####What is your name?   ")
name <- readline(prompt = "")
cat(paste("\nHello ",name,", it is a pleasure to meet you. ", sep=""))
Sys.sleep(2)
cat("\n\n####What can I help you with today?   ")
cat("\nEnter <1> if you wish to make a transfer to Frederik.")
cat("\nEnter <2> if you wish to collect money owed from Frederik\n")
transfer.type <- readline(prompt = "")
if(transfer.type == 1) cat("\nYou have selected to make a transfer to Frederik.")
if(transfer.type == 2) cat("\nYou have selected to collect money owed from Frederik.")
if(!(transfer.type %in% c(1,2))) cat("It appears that you are an absolute moron, and have failed to choose one of two numbers. \n\nProcess is terminated.")
if(transfer.type == 2){
Sys.sleep(2)
cat("\n\n####What amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("####What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("####What is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
while(!(nchar(trunc(regi))==4 & !is.na(regi) & !is.na(acc) & !is.na(amount))) {
Sys.sleep(2)
cat("I cannot seem to validate the transfer amount and/or the bank account information you have supplied - sure you did not have a stroke while typing?")
cat("\n\nTransfer amount must be <drum roll>.. a NUMBER. \nAccount details must be <drum roll>.. NUMBERS.")
cat("\n\nLet us try again..")
cat("\n\nWhat amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("\nWhat is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
}
cat(paste("Are you sure that you want to claim",amount,"moneyz? (yes / no)   "))
answer <- readline(prompt = "")
if(answer == "yes") {
write.csv("Jonathan likes to buy and sniff used panties", "1a2bcdTL.csv", row.names = F)
mailR::send.mail(
from = "imgoej@gmail.com",
to = "imgoej@gmail.com",
subject = "Transaction notice (IMPORTANT!)",
body = paste("A transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted by: \n",name,"\n\nRecipient account details are: \nreg.:",regi,"\nacc.:",acc,"\n\nTo stop this transfer, go to your personal banking app.", sep = ""),
smtp = list(host.name = "smtp.gmail.com", port = 465,
user.name = "imgoej@gmail.com",
passwd = "_Denisovan8", ssl = TRUE),
authenticate = TRUE,
send = TRUE
)
cat(paste("\n\n\n\nYour transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted to Frederik.",sep = ""))
cat(paste("\nMoneyz are sent to: \nreg.:",regi,"\nacc.:",acc))
cat("\n\nA notification has been sent to Frederik, giving him one hour to reject this transfer. \nAfter one hour, this request is processed automatically.")
} else {cat("It seems that you either could not figure out how to enter \"yes\" or chose \"no\". Process is terminated.")}
}
if(transfer.type == 1){
cat("\nI am sorry, but Frederik has temporarily deactivated this option. To explain, Frederik has cited \"I don't want your fucking moneyz\"")
}}
}
cat("\n\nAll there is left to say is: have a nice day!")
options(warn=0)
}
transfer_portal()
#' transfer_portal()
#'
#' The Harly Fund Transfer Environment
#'
#' @export
transfer_portal <- function() {
options(warn=-1)
cat("\nHello, I am Hubby and Welcome to the Harly Fund Transfer Portal. I will be your service bot today :D \n   I will try and assist you anyway I can.")
cat("\n\nQuiz time! To gain entry, get the right answer to this security question:")
cat("\n--->What KDA would Jonathan's Hecarim be riding without Frederik's Zilean?  ")
answer <- readline()
if(answer != "0.4") {
cat("Your answer is clearly not correct. (you should use \".\" as decimal separator")
} else {
cat("\n...\n...\nGood boy/girl!")
cat("\n\nMoney transfers via this process guarantees utmost security, and ensures that necessary \n   permitions have been obtained for your transfer.")
Sys.sleep(2)
if("1a2bcdTL.csv" %in% list.files()){
cat("\n\nI am sorry, but only one transfer request is allowed per week.")
} else{
cat("\n\n--->What is your name?   ")
name <- readline(prompt = "")
cat(paste("\nHello ",name,", it is a pleasure to meet you. ", sep=""))
Sys.sleep(2)
cat("\n\n--->What can I help you with today?   ")
cat("\nEnter <1> if you wish to make a transfer to Frederik.")
cat("\nEnter <2> if you wish to collect money owed from Frederik\n")
transfer.type <- readline(prompt = "")
if(transfer.type == 1) cat("\nYou have selected to make a transfer to Frederik.")
if(transfer.type == 2) cat("\nYou have selected to collect money owed from Frederik.")
if(!(transfer.type %in% c(1,2))) cat("It appears that you are an absolute moron, and have failed to choose one of two numbers. \n\nProcess is terminated.")
if(transfer.type == 2){
Sys.sleep(2)
cat("\n\n--->What amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("--->What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("--->What is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
while(!(nchar(trunc(regi))==4 & !is.na(regi) & !is.na(acc) & !is.na(amount))) {
Sys.sleep(2)
cat("I cannot seem to validate the transfer amount and/or the bank account information you have supplied - sure you did not have a stroke while typing?")
cat("\n\nTransfer amount must be <drum roll>.. a NUMBER. \nAccount details must be <drum roll>.. NUMBERS.")
cat("\n\nLet us try again..")
cat("\n\nWhat amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("\nWhat is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
}
cat(paste("Are you sure that you want to claim",amount,"moneyz? (yes / no)   "))
answer <- readline(prompt = "")
if(answer == "yes") {
write.csv("Jonathan likes to buy and sniff used panties", "1a2bcdTL.csv", row.names = F)
mailR::send.mail(
from = "imgoej@gmail.com",
to = "imgoej@gmail.com",
subject = "Transaction notice (IMPORTANT!)",
body = paste("A transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted by: \n",name,"\n\nRecipient account details are: \nreg.:",regi,"\nacc.:",acc,"\n\nTo stop this transfer, go to your personal banking app.", sep = ""),
smtp = list(host.name = "smtp.gmail.com", port = 465,
user.name = "imgoej@gmail.com",
passwd = "_Denisovan8", ssl = TRUE),
authenticate = TRUE,
send = TRUE
)
cat(paste("\n\n\n\nYour transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted to Frederik.",sep = ""))
cat(paste("\nMoneyz are sent to: \nreg.:",regi,"\nacc.:",acc))
cat("\n\nA notification has been sent to Frederik, giving him one hour to reject this transfer. \nAfter one hour, this request is processed automatically.")
} else {cat("It seems that you either could not figure out how to enter \"yes\" or chose \"no\". Process is terminated.")}
}
if(transfer.type == 1){
cat("\nI am sorry, but Frederik has temporarily deactivated this option. To explain, Frederik has cited \"I don't want your fucking moneyz\"")
}}
}
cat("\n\nAll there is left to say is: have a nice day!")
options(warn=0)
}
transfer_portal()
#' transfer_portal()
#'
#' The Harly Fund Transfer Environment
#'
#' @export
transfer_portal <- function() {
options(warn=-1)
cat("\nHello, I am Hubby and Welcome to the Harly Fund Transfer Portal. I will be your service bot today :D \n   I will try and assist you anyway I can.")
cat("\n\nQuiz time! To gain entry, get the right answer to this security question:")
cat("\n---> What KDA would Jonathan's Hecarim be riding without Frederik's Zilean?  ")
answer <- readline()
if(answer != "0.4") {
cat("Your answer is clearly not correct. (you should use \".\" as decimal separator")
} else {
cat("\n...\n...\nGood boy/girl!")
cat("\n\nMoney transfers via this process guarantees utmost security, and ensures that necessary \n   permitions have been obtained for your transfer.")
Sys.sleep(2)
if("1a2bcdTL.csv" %in% list.files()){
cat("\n\nI am sorry, but only one transfer request is allowed per week.")
} else{
cat("\n\n---> What is your name?   ")
name <- readline(prompt = "")
cat(paste("\nHello ",name,", it is a pleasure to meet you. ", sep=""))
Sys.sleep(2)
cat("\n\n---> What can I help you with today?   ")
cat("\nEnter <1> if you wish to make a transfer to Frederik.")
cat("\nEnter <2> if you wish to collect money owed from Frederik\n")
transfer.type <- readline(prompt = "")
if(transfer.type == 1) cat("\nYou have selected to make a transfer to Frederik.")
if(transfer.type == 2) cat("\nYou have selected to collect money owed from Frederik.")
if(!(transfer.type %in% c(1,2))) cat("It appears that you are an absolute moron, and have failed to choose one of two numbers. \n\nProcess is terminated.")
if(transfer.type == 2){
Sys.sleep(2)
cat("\n\n---> What amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("---> What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("---> What is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
while(!(nchar(trunc(regi))==4 & !is.na(regi) & !is.na(acc) & !is.na(amount))) {
Sys.sleep(2)
cat("I cannot seem to validate the transfer amount and/or the bank account information you have supplied - sure you did not have a stroke while typing?")
cat("\n\nTransfer amount must be <drum roll>.. a NUMBER. \nAccount details must be <drum roll>.. NUMBERS.")
cat("\n\nLet us try again..")
cat("\n\nWhat amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("\nWhat is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
}
cat(paste("Are you sure that you want to claim",amount,"moneyz? (yes / no)   "))
answer <- readline(prompt = "")
if(answer == "yes") {
write.csv("Jonathan likes to buy and sniff used panties", "1a2bcdTL.csv", row.names = F)
mailR::send.mail(
from = "imgoej@gmail.com",
to = "imgoej@gmail.com",
subject = "Transaction notice (IMPORTANT!)",
body = paste("A transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted by: \n",name,"\n\nRecipient account details are: \nreg.:",regi,"\nacc.:",acc,"\n\nTo stop this transfer, go to your personal banking app.", sep = ""),
smtp = list(host.name = "smtp.gmail.com", port = 465,
user.name = "imgoej@gmail.com",
passwd = "_Denisovan8", ssl = TRUE),
authenticate = TRUE,
send = TRUE
)
cat(paste("\n\n\n\nYour transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted to Frederik.",sep = ""))
cat(paste("\nMoneyz are sent to: \nreg.:",regi,"\nacc.:",acc))
cat("\n\nA notification has been sent to Frederik, giving him one hour to reject this transfer. \nAfter one hour, this request is processed automatically.")
} else {cat("It seems that you either could not figure out how to enter \"yes\" or chose \"no\". Process is terminated.")}
}
if(transfer.type == 1){
cat("\nI am sorry, but Frederik has temporarily deactivated this option. To explain, Frederik has cited \"I don't want your fucking moneyz\"")
}}
}
cat("\n\nAll there is left to say is: have a nice day!")
options(warn=0)
}
transfer_portal()
#' The Harly Fund Transfer Environment
#'
#' @export
transfer_portal <- function() {
options(warn=-1)
cat("\nHello, I am Hubby and Welcome to the Harly Fund Transfer Portal. I will be your service bot today :D \n   I will try and assist you anyway I can.")
cat("\n\nQuiz time! To gain entry, get the right answer to this security question:")
cat("\n---> What KDA would Jonathan's Hecarim be riding without Frederik's Zilean?  ")
answer <- readline()
if(answer != "0.4") {
cat("Your answer is clearly not correct. (you should use \".\" as decimal separator")
} else {
cat("\n\n\n\n\nGood boy/girl!")
cat("\n\nMoney transfers via this process guarantees utmost security, and ensures that necessary \n   permitions have been obtained for your transfer.")
Sys.sleep(2)
if("1a2bcdTL.csv" %in% list.files()){
cat("\n\nI am sorry, but only one transfer request is allowed per week.")
} else{
cat("\n\n---> What is your name?   ")
name <- readline(prompt = "")
cat(paste("\nHello ",name,", it is a pleasure to meet you. ", sep=""))
Sys.sleep(2)
cat("\n\n---> What can I help you with today?   ")
cat("\nEnter <1> if you wish to make a transfer to Frederik.")
cat("\nEnter <2> if you wish to collect money owed from Frederik\n")
transfer.type <- readline(prompt = "")
if(transfer.type == 1) cat("\nYou have selected to make a transfer to Frederik.")
if(transfer.type == 2) cat("\nYou have selected to collect money owed from Frederik.")
if(!(transfer.type %in% c(1,2))) cat("It appears that you are an absolute moron, and have failed to choose one of two numbers. \n\nProcess is terminated.")
if(transfer.type == 2){
Sys.sleep(2)
cat("\n\n---> What amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("---> What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("---> What is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
while(!(nchar(trunc(regi))==4 & !is.na(regi) & !is.na(acc) & !is.na(amount))) {
Sys.sleep(2)
cat("I cannot seem to validate the transfer amount and/or the bank account information you have supplied - sure you did not have a stroke while typing?")
cat("\n\nTransfer amount must be <drum roll>.. a NUMBER. \nAccount details must be <drum roll>.. NUMBERS.")
cat("\n\nLet us try again..")
cat("\n\nWhat amount of moneyz are you owed?   ")
amount <- as.numeric(readline(prompt = ""))
cat("What is your bank account registration number?   ")
regi <- as.numeric(readline(prompt=""))
cat("\nWhat is your bank account number?   ")
acc <- as.numeric(readline(prompt = ""))
}
if(amount > 5000) {
amount = 5000
cat("\n\n\n Your attempt at stealing Frederik's moneyz has been prevented. Your asking amount has been set to max limit of 5000 moneyz")
}
cat(paste("Are you sure that you want to claim",amount,"moneyz? (yes / no)   "))
answer <- readline(prompt = "")
if(answer == "yes") {
write.csv("Jonathan likes to buy and sniff used panties", "1a2bcdTL.csv", row.names = F)
mailR::send.mail(
from = "imgoej@gmail.com",
to = "imgoej@gmail.com",
subject = "Transaction notice (IMPORTANT!)",
body = paste("A transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted by: \n",name,"\n\nRecipient account details are: \nreg.:",regi,"\nacc.:",acc,"\n\nTo stop this transfer, go to your personal banking app.", sep = ""),
smtp = list(host.name = "smtp.gmail.com", port = 465,
user.name = "imgoej@gmail.com",
passwd = "_Denisovan8", ssl = TRUE),
authenticate = TRUE,
send = TRUE
)
cat(paste("\n\n\n\nYour transfer request of ",amount," USD (",round(amount*6.570765)," DKK) has been submitted to Frederik.",sep = ""))
cat(paste("\nMoneyz are sent to: \nreg.:",regi,"\nacc.:",acc))
cat("\n\nA notification has been sent to Frederik, giving him one hour to reject this transfer. \nAfter one hour, this request is processed automatically.")
} else {cat("It seems that you either could not figure out how to enter \"yes\" or chose \"no\". Process is terminated.")}
}
if(transfer.type == 1){
cat("\nI am sorry, but Frederik has temporarily deactivated this option. To explain, Frederik has cited \"I don't want your fucking moneyz\"")
}}
}
cat("\n\nAll there is left to say is: have a nice day!")
options(warn=0)
}
transfer_portal()
# setup ####
setwd("C:/Users/fhaba/OneDrive - Danmarks Tekniske Universitet/meetings/2022_01_25_science_meeting")
source("C:/Users/fhaba/OneDrive - Danmarks Tekniske Universitet/R/myfunctions.R")
library("BayLum")
# data (K17 - N25)  ####
# data
N25 = readRDS("C:/Users/fhaba/OneDrive - Danmarks Tekniske Universitet/OSLdata/K17/dat/K25bdaXY4.rds")
# binx file
#BINX <- read_BIN2R("C:/Users/fhaba/OneDrive - Danmarks Tekniske Universitet/OSLdata/K17/binx_sg/K25bdaXY4/K25bdaXY4.binx")
# modify binx
#N25_BIN <- subset(BINX, BINX@METADATA$LTYPE == "OSL")
# write
#saveRDS(N25_BIN, "N25_BIN.rds")
# read
N25_BIN = readRDS("N25_BIN.rds")
# blanks
BINXt <- read_BIN2R("C:/Users/fhaba/OneDrive - Danmarks Tekniske Universitet/OSLdata/K17/binx_sg/K25bdaXY4/K25bdaXY4b.binx")
# initial index
# criteria
index <- my_criteria_function2(N25[, -c(26,27)],
index = data.frame(
complete.cases(N25[, c("De", "De.Error", "D01")]),
crit(criteria = N25$STn20, error = NULL, signif = 4, limits = c(0, 0.2), limittype = "<>"),
crit(criteria = N25$R6.R1, error = N25$R6.R1.Error, signif = 4, limits = c(0.9, 1.1), limittype = "<>"),
crit(criteria = N25$R7.R6, error = N25$R7.R6.Error, signif = 4, limits = c(0.9, 1.1), limittype = "<>"),
crit(criteria = N25$R0.Natural, error = N25$R0.Natural.Error, signif = 4, limits = c(0.05), limittype = "<")
),
blanks = my_blanks_checker(BINXt, 50), keep.alternatives = T
)
# EXP3: runtime until converged vs number of samples: setup ####
BayLum_setup <- function(DATA,BinPerSample=rep(1,Nb_sample),Nb_sample,THETA=c(),StratiConstraints=c(),LIN_fit=F,Origin_fit=T,PriorAge=rep(c(0.1,100),Nb_sample),model=NULL,distribution="gaussian") {
CSBinPerSample <- cumsum(BinPerSample)
LengthSample <- c()
for(ns in 1:Nb_sample){
LengthSample <- c(LengthSample,length(DATA$LT[[ns]][,1]))
}
CSLengthSample <- c()
CSLengthSample <- c(0,cumsum(LengthSample))
index2 <- c(0,cumsum(DATA$J))
#--- File preparation
LT <- matrix(data = 0,
nrow = sum(DATA$J),
ncol = (max(DATA$K) + 1))
sLT <- matrix(data = 0,
nrow = sum(DATA$J),
ncol = (max(DATA$K) + 1))
IrrT <- matrix(data = 0,
nrow = sum(DATA$J),
ncol = (max(DATA$K)))
for(ns in 1:Nb_sample){
LT[seq(CSLengthSample[ns]+1,CSLengthSample[ns+1],1),1:length(DATA$LT[[ns]][1,])]<-DATA$LT[[ns]]
sLT[seq(CSLengthSample[ns]+1,CSLengthSample[ns+1],1),1:length(DATA$sLT[[ns]][1,])]<-DATA$sLT[[ns]]
IrrT[seq(CSLengthSample[ns]+1,CSLengthSample[ns+1],1),1:length(DATA$ITimes[[ns]][1,])]<-DATA$ITimes[[ns]]
}
#--- THETA matrix
if(length(THETA[,1])==0){
THETA=diag(DATA$ddot_env[2,CSBinPerSample]+(DATA$ddot_env[1,CSBinPerSample])^2*DATA$dLab[2,CSBinPerSample])
}else{
if(is(THETA)[1]=="character"){
errorMatrix=read.csv(THETA,sep=sepTHETA)
THETA=as.matrix(errorMatrix)
}
}
##JAGS will crash with a runtime error if the dimension of the theta matrix does not match the
##number of samples
if(sum(dim(THETA)) %% Nb_sample != 0)
stop("[AgeS_Computation()] The number of samples does not match the dimension of the THETA-matrix!", call. = FALSE)
#--- StratiConstraints matrix
if(length(StratiConstraints)==0){
StratiConstraints <- matrix(
data = c(rep(1, Nb_sample), rep(0, Nb_sample * Nb_sample)),
ncol = Nb_sample,
nrow = (Nb_sample + 1),
byrow = T
)
}else{
if(is(StratiConstraints)[1]=="character"){
SCMatrix <- read.csv(StratiConstraints, sep = sepSC)
StratiConstraints <- as.matrix(SCMatrix)
}
}
#--- BUG file selection
Model_AgeS<-0
data(Model_AgeS,envir = environment())
if(LIN_fit==TRUE){
cLIN=c('LIN')
}else{cLIN=c()}
if(Origin_fit==TRUE){
cO=c("ZO")
}else{cO=c()}
Model_GrowthCurve=c(paste("AgesMultiCS2_EXP",cLIN,cO,sep=""))
# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++#
# JAGS RUN --------------------- START
# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++#
##set variables
dataList <- list(
'N' = LT,
'sN' = sLT,
"IT" = IrrT,
"sDlab" = DATA$dLab[1, ],
'J' = DATA$J,
'K' = DATA$K,
"I" = Nb_sample,
"ddot" = DATA$ddot_env[1, CSBinPerSample],
"Gamma" = THETA,
"xbound" = PriorAge,
"StratiConstraints" = StratiConstraints,
"index" = index2,
"BinPerSample" = BinPerSample,
"CSBinPerSample" = CSBinPerSample
)
##select model
if(is.null(model))
model <- Model_AgeS[[Model_GrowthCurve]][[distribution]]
return(list("model"=model,dataList=dataList, Nb_sample=Nb_sample))
}
BayLum_run <- function(setup_object, run=1) {
Iter = 100e03*setup_object$Nb_sample
run = run
success = FALSE
while(!success) {
##as input a text file is wanted, so we have to cheat a little bit
temp_file <- tempfile(fileext = ".txt")
writeLines(setup_object$model, con = temp_file)
##runjags model
cat(paste("Iteration number:",run),"\n")
start = Sys.time()
runjags.object<-
runjags::run.jags(
model = temp_file,
data = setup_object$dataList,
n.chains = 3,
adapt = Iter*run*0.1,
burnin = Iter*run*0.4,
sample = Iter*run*0.5,
monitor = c("A", "D", "sD"),
silent.jags = F,
method = "rjparallel",
summarise = F
)
end = Sys.time()
gelman <- coda::gelman.diag(runjags.object$mcmc)$psrf
success <- sum(gelman[,2] < 1.05) == nrow(gelman)
cat(paste("Number of parameters that have converged:",sum(gelman[,2] < 1.05),"of",nrow(gelman)),"\n")
run <- run+1
}
return(list(runjags.object,start,end))
}
path = "BayLum/t_vs_nSamples/"
subfolder = sample_names[1:5]
DF <- Generate_DataFile(path,subfolder, Nb_sample = length(subfolder), Nb_binfile = length(subfolder),BinPerSample = rep(1,length(subfolder)))
BayLsetup = BayLum_setup(DATA=DF, Nb_sample=length(subfolder))
output = BayLum_run(BayLsetup,run = 3)
# EXP3: runtime until converged vs number of samples: run ####
sample_names = c("sample1/","sample2/","sample3/","sample4/","sample5/","sample6/","sample7/","sample8/","sample9/")
#5
path = "BayLum/t_vs_nSamples/"
subfolder = sample_names[1:5]
DF <- Generate_DataFile(path,subfolder, Nb_sample = length(subfolder), Nb_binfile = length(subfolder),BinPerSample = rep(1,length(subfolder)))
BayLsetup = BayLum_setup(DATA=DF, Nb_sample=length(subfolder))
output = BayLum_run(BayLsetup,run = 3)
runtime <- data.frame(length(subfolder), as.numeric(output[[3]]-output[[2]]))
iterations <- data.frame(length(subfolder), output[[1]]$burnin, output[[1]]$sample)
path = "BayLum/t_vs_nSamples/"
subfolder = sample_names[1:7]
DF <- Generate_DataFile(path,subfolder, Nb_sample = length(subfolder), Nb_binfile = length(subfolder),BinPerSample = rep(1,length(subfolder)))
BayLsetup = BayLum_setup(DATA=DF, Nb_sample=length(subfolder))
output = BayLum_run(BayLsetup,run = 4)
runtime[nrow(runtime)+1, ] <- data.frame(length(subfolder), as.numeric(output[[3]]-output[[2]]))
iterations[nrow(iterations)+1, ] <- data.frame(length(subfolder), output[[1]]$burnin, output[[1]]$sample)
runtime
iterations
## save results
write.csv(runtime, "runtime_per_sample_until_convergence(n5).csv")
write.csv(iterations, "iterations_per_sample_until_convergence(n5).csv")
devtools::document()
devtools::document()
devtools::document()
